parameters:
- name: IncludeHigherPriorityTestSuites
  default: $(IncludeHigherPriorityTestSuites)
- name: TestSuite
  default: $(TestSuite)

steps:
- powershell: |
   # These should have been set by the variables in a pipeline
   
   Write-Host "TestSuite = $(TestSuite)"
   Write-Host "IncludeHigherPriorityTestSuites = $(IncludeHigherPriorityTestSuites)"
   
  displayName: 'Display Parameter Values'

- task: securedevelopmentteam.vss-secure-development-tools.build-task-publishsecurityanalysislogs.PublishSecurityAnalysisLogs@3
  displayName: '(P0) Publish Security Analysis Logs: All Tools'
  continueOnError: true
  condition: and(succeeded(), or(eq(variables['TestSuite'], 'P0'), eq(variables['IncludeHigherPriorityTestSuites'], 'true')))

# This test is to ensure that when a new task is added, it must also have "required == false".
# Any tool that runs in the suite could be true or false.
# If a tool doesn't run in the suite, it must be false.
- task: securedevelopmentteam.vss-secure-development-tools.build-task-publishsecurityanalysislogs.PublishSecurityAnalysisLogs@3
  displayName: '(P0) Publish Security Analysis Logs: Tool Not Found Error'
  continueOnError: true
  condition: and(succeeded(), or(eq(variables['TestSuite'], 'P0'), eq(variables['IncludeHigherPriorityTestSuites'], 'true')))
  inputs:
      ArtifactName: 'CodeAnalysisLogs'
      ArtifactType: 'Container'
      AllTools: false
      AntiMalware: true
      APIScan: false
      Armory: true
      Bandit: false
      BinSkim: true
      CodesignValidation: false
      CredScan: true
      CSRF: false
      ESLint: false
      Flawfinder: false
      FortifySCA: false
      FxCop: false
      ModernCop: false
      MSRD: false
      PoliCheck: false
      RoslynAnalyzers: false
      SDLNativeRules: false
      Semmle: false
      SpotBugs: false
      TSLint: false
      WebScout: false
      ToolLogsNotFoundAction: 'Error'

#
# More permutations / variations to be added here
#
